experiment_name: "srg_${n}_${k}_${lambda_param}_${mu}"
defaults:
  - base_config
  - override /hydra/launcher: HPC_2HRS_GPU
  - _self_

# Multirun configuration for all SRG parameter sets up to 16 vertices
# Based on https://aeb.win.tue.nl/graphs/srg/srgtab1-50.html
hydra:
  mode: MULTIRUN
  job:
    name: "srg_${n}_${k}_${lambda_param}_${mu}"
  sweeper:
    _target_: hydra._internal.core.plugins.basic_sweeper.BasicSweeper
    params:
      # Each line represents one valid SRG parameter set (n,k,lambda,mu)
      +experiment_params: "n=5,k=2,lambda_param=0,mu=1",
                          "n=9,k=4,lambda_param=1,mu=2",
                          "n=10,k=3,lambda_param=0,mu=1",
                          "n=10,k=6,lambda_param=4,mu=4",
                          "n=13,k=6,lambda_param=2,mu=3",
                          "n=15,k=6,lambda_param=1,mu=3",
                          "n=15,k=8,lambda_param=4,mu=4",
                          "n=16,k=5,lambda_param=0,mu=2",
                          "n=16,k=6,lambda_param=2,mu=2",
                          "n=16,k=9,lambda_param=12,mu=16"

# Default values (will be overridden by sweep)
n: 5
k: 2
lambda_param: 0
mu: 1

logger:
  wandb_mode: "online"
  use_progress_bar: false
  group: "strongly_regular_graphs"
  tags: ["multirun", "srg-search", "up-to-16-vertices", "slurm", "n=${n}", "k=${k}", "lambda=${lambda_param}", "mu=${mu}"]           
  notes: "Search for (${n},${k},${lambda_param},${mu})-SRG from Andries Brouwer's table"

problem:
  _target_: thesis.problems.StronglyRegularGraphs
  n: ${n}
  k: ${k}
  lambda_param: ${lambda_param}
  mu: ${mu}

model:
  _target_: thesis.models.FFModel
  n: ${n}
  hidden_layer_sizes: [512, 128, 128, 128, 64, 16]

algorithm:
  _target_: thesis.algorithms.deep_cross_entropy.WagnerDeepCrossEntropy
  iterations: 5000
  batch_size: 32384
  learning_rate: 0.001
  elite_proportion: 0.1
  early_stopping_patience: 300
